title: æ•°æ®ç»“æ„ä¸ç®—æ³•â€”â€”å¸Œå°”æ’åº
date: 2020-10-26
template:carticle


[TOC]

## ç®—æ³•åŸç†

å¸Œå°”æ’åºï¼Œä¹Ÿç§°é€’å‡å¢é‡æ’åºç®—æ³•ï¼Œæ˜¯æ’å…¥æ’åºçš„ä¸€ç§æ›´é«˜æ•ˆçš„æ”¹è¿›ç‰ˆæœ¬ã€‚ä½†å¸Œå°”æ’åºæ˜¯éç¨³å®šæ’åºç®—æ³•ã€‚

å¸Œå°”æ’åºæ˜¯åŸºäºæ’å…¥æ’åºçš„ä»¥ä¸‹ä¸¤ç‚¹æ€§è´¨è€Œæå‡ºæ”¹è¿›æ–¹æ³•çš„ï¼š

- æ’å…¥æ’åºåœ¨å¯¹å‡ ä¹å·²ç»æ’å¥½åºçš„æ•°æ®æ“ä½œæ—¶ï¼Œæ•ˆç‡é«˜ï¼Œå³å¯ä»¥è¾¾åˆ°çº¿æ€§æ’åºçš„æ•ˆç‡ï¼›
- ä½†æ’å…¥æ’åºä¸€èˆ¬æ¥è¯´æ˜¯ä½æ•ˆçš„ï¼Œå› ä¸ºæ’å…¥æ’åºæ¯æ¬¡åªèƒ½å°†æ•°æ®ç§»åŠ¨ä¸€ä½ï¼›

å¸Œå°”æ’åºçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šå…ˆå°†æ•´ä¸ªå¾…æ’åºçš„è®°å½•åºåˆ—åˆ†å‰²æˆä¸ºè‹¥å¹²å­åºåˆ—åˆ†åˆ«è¿›è¡Œç›´æ¥æ’å…¥æ’åºï¼Œå¾…æ•´ä¸ªåºåˆ—ä¸­çš„è®°å½•"åŸºæœ¬æœ‰åº"æ—¶ï¼Œå†å¯¹å…¨ä½“è®°å½•è¿›è¡Œä¾æ¬¡ç›´æ¥æ’å…¥æ’åºã€‚**è¯¥æ–¹æ³•å®è´¨ä¸Šæ˜¯ä¸€ç§åˆ†ç»„æ’å…¥æ–¹æ³•**ã€‚

å¸Œå°”æ’åºæŠŠå…ƒç´ æŒ‰ä¸‹æ ‡çš„ä¸€å®šå¢é‡åˆ†ç»„ï¼Œå¯¹æ¯ç»„ä½¿ç”¨ç›´æ¥æ’å…¥æ’åºç®—æ³•æ’åºï¼›éšç€å¢é‡é€æ¸å‡å°‘ï¼Œæ¯ç»„åŒ…å«çš„å…³é”®è¯è¶Šæ¥è¶Šå¤šï¼Œå½“å¢é‡å‡è‡³1æ—¶ï¼Œæ•´ä¸ªæ–‡ä»¶æ°è¢«åˆ†æˆä¸€ç»„ï¼Œç®—æ³•ä¾¿ç»ˆæ­¢ã€‚

ç®€å•æ’å…¥æ’åºå¾ˆå¾ªè§„è¹ˆçŸ©ï¼Œä¸ç®¡æ•°ç»„åˆ†å¸ƒæ˜¯æ€ä¹ˆæ ·çš„ï¼Œä¾ç„¶ä¸€æ­¥ä¸€æ­¥çš„å¯¹å…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œç§»åŠ¨ï¼Œæ’å…¥ï¼Œæ¯”å¦‚[5,4,3,2,1,0]è¿™ç§å€’åºåºåˆ—ï¼Œæ•°ç»„æœ«ç«¯çš„0è¦å›åˆ°é¦–ä½ç½®å¾ˆæ˜¯è´¹åŠ²ï¼Œæ¯”è¾ƒå’Œç§»åŠ¨å…ƒç´ å‡éœ€n-1æ¬¡ã€‚è€Œå¸Œå°”æ’åºåœ¨æ•°ç»„ä¸­é‡‡ç”¨è·³è·ƒå¼åˆ†ç»„çš„ç­–ç•¥ï¼Œé€šè¿‡æŸä¸ªå¢é‡å°†æ•°ç»„å…ƒç´ åˆ’åˆ†ä¸ºè‹¥å¹²ç»„ï¼Œç„¶ååˆ†ç»„è¿›è¡Œæ’å…¥æ’åºï¼Œéšåé€æ­¥ç¼©å°å¢é‡ï¼Œç»§ç»­æŒ‰ç»„è¿›è¡Œæ’å…¥æ’åºæ“ä½œï¼Œç›´è‡³å¢é‡ä¸º1ã€‚å¸Œå°”æ’åºé€šè¿‡è¿™ç§ç­–ç•¥ä½¿å¾—æ•´ä¸ªæ•°ç»„åœ¨åˆå§‹é˜¶æ®µè¾¾åˆ°ä»å®è§‚ä¸Šçœ‹åŸºæœ¬æœ‰åºï¼Œå°çš„åŸºæœ¬åœ¨å‰ï¼Œå¤§çš„åŸºæœ¬åœ¨åã€‚ç„¶åç¼©å°å¢é‡ï¼Œåˆ°å¢é‡ä¸º1æ—¶ï¼Œå…¶å®å¤šæ•°æƒ…å†µä¸‹åªéœ€å¾®è°ƒå³å¯ï¼Œä¸ä¼šæ¶‰åŠè¿‡å¤šçš„æ•°æ®ç§»åŠ¨ã€‚

æˆ‘ä»¬æ¥çœ‹ä¸‹å¸Œå°”æ’åºçš„åŸºæœ¬æ­¥éª¤ï¼Œåœ¨æ­¤æˆ‘ä»¬é€‰æ‹©å¢é‡gap=length/2ï¼Œç¼©å°å¢é‡ç»§ç»­ä»¥gap = gap/2çš„æ–¹å¼ï¼Œè¿™ç§å¢é‡é€‰æ‹©æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªåºåˆ—æ¥è¡¨ç¤ºï¼Œ{n/2,(n/2)/2...1}ï¼Œç§°ä¸º**å¢é‡åºåˆ—**ã€‚å¸Œå°”æ’åºçš„å¢é‡åºåˆ—çš„é€‰æ‹©ä¸è¯æ˜æ˜¯ä¸ªæ•°å­¦éš¾é¢˜ï¼Œæˆ‘ä»¬é€‰æ‹©çš„è¿™ä¸ªå¢é‡åºåˆ—æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ï¼Œä¹Ÿæ˜¯å¸Œå°”å»ºè®®çš„å¢é‡ï¼Œç§°ä¸ºå¸Œå°”å¢é‡ï¼Œä½†å…¶å®è¿™ä¸ªå¢é‡åºåˆ—ä¸æ˜¯æœ€ä¼˜çš„ã€‚æ­¤å¤„æˆ‘ä»¬åšç¤ºä¾‹ä½¿ç”¨å¸Œå°”å¢é‡ã€‚

![img](https://images2015.cnblogs.com/blog/1024555/201611/1024555-20161128110416068-1421707828.png)

## ä»£ç å®ç°

åœ¨å¸Œå°”æ’åºçš„ç†è§£æ—¶ï¼Œæˆ‘ä»¬å€¾å‘äºå¯¹äºæ¯ä¸€ä¸ªåˆ†ç»„ï¼Œé€ç»„è¿›è¡Œå¤„ç†ï¼Œä½†åœ¨ä»£ç å®ç°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨è¿™ä¹ˆæŒ‰éƒ¨å°±ç­åœ°å¤„ç†å®Œä¸€ç»„å†è°ƒè½¬å›æ¥å¤„ç†ä¸‹ä¸€ç»„ï¼ˆè¿™æ ·è¿˜å¾—åŠ ä¸ªforå¾ªç¯å»å¤„ç†åˆ†ç»„ï¼‰æ¯”å¦‚[5,4,3,2,1,0] ï¼Œé¦–æ¬¡å¢é‡è®¾step=length/2=3,åˆ™ä¸º3ç»„[5,2] [4,1] [3,0]ï¼Œå®ç°æ—¶ä¸ç”¨å¾ªç¯æŒ‰ç»„å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸‹æ ‡ä¸ºstepçš„å…ƒç´ å¼€å§‹ï¼Œé€ä¸ªè·¨ç»„å¤„ç†ã€‚åŒæ—¶ï¼Œåœ¨æ’å…¥æ•°æ®æ—¶ï¼Œå¯ä»¥é‡‡ç”¨å…ƒç´ äº¤æ¢æ³•å¯»æ‰¾æœ€ç»ˆä½ç½®ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨æ•°ç»„å…ƒç´ ç§»åŠ¨æ³•å¯»è§…ã€‚å¸Œå°”æ’åºçš„ä»£ç æ¯”è¾ƒç®€å•ï¼Œå…±åŒ…å«ä¸‰å±‚forå¾ªç¯ï¼Œå¦‚ä¸‹ï¼š

```java
public static int[] shell_sort(int[] nums) {
    int[] arr = Arrays.copyOf(nums, nums.length);
    // è¿­ä»£é€æ­¥ç¼©å°å¢é‡step
    for (int step=nums.length/2; step>0; step/=2) {
        // ä»ä¸‹æ ‡ä¸ºstepçš„å…ƒç´ å¼€å§‹ï¼Œé€ä¸ªå¯¹å…¶æ‰€åœ¨ç»„è¿›è¡Œç›´æ¥æ’å…¥æ’åºæ“ä½œ
        for (int i=step; i<nums.length; i++) {
            int target = arr[i];
            int j;
            // ç§»åŠ¨æ’å…¥æ³•
            for (j=i; j-step>=0 && target<arr[j-step]; j-=step) {
                arr[j] = arr[j-step];
            }
            arr[j] = target;
        }
    }
    return arr;
}
```

## å¢é‡åºåˆ—åŠæ—¶é—´å¤æ‚åº¦

[Shellæ’åº](https://baike.baidu.com/item/Shellæ’åº)çš„æ‰§è¡Œæ—¶é—´ä¾èµ–äº[å¢é‡](https://baike.baidu.com/item/å¢é‡)åºåˆ—ã€‚

å¥½çš„[å¢é‡](https://baike.baidu.com/item/å¢é‡)åºåˆ—çš„å…±åŒç‰¹å¾ï¼š

â‘  æœ€åä¸€ä¸ª[å¢é‡](https://baike.baidu.com/item/å¢é‡)å¿…é¡»ä¸º1ï¼›

â‘¡ åº”è¯¥å°½é‡é¿å…åºåˆ—ä¸­çš„å€¼(å°¤å…¶æ˜¯ç›¸é‚»çš„å€¼)äº’ä¸ºå€æ•°çš„æƒ…å†µã€‚

![img](https://img2020.cnblogs.com/blog/1255171/202003/1255171-20200303214131806-1135957907.png)

![image](https://user-images.githubusercontent.com/20717515/87876225-33c0a100-ca09-11ea-9cf3-15f65cb6682b.png)

### Shell å¢é‡åºåˆ—

Shell å¢é‡åºåˆ—çš„é€’æ¨å…¬å¼ä¸ºï¼š
$$
h_t=N/2,h_k=h_{k+1}/2
$$
å¯¹äºæ¯æ¬¡é™¤ä»¥ 2 çš„å¢é‡é€‰æ‹©ï¼Œå¸Œå°”æ’åºçš„æœ€å¥½æƒ…å†µå½“ç„¶æ˜¯æœ¬èº«æœ‰åºï¼Œæ¯æ¬¡åˆ†åŒºéƒ½ä¸ç”¨æ’åºï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ `O(n)`ï¼›ä½†æ˜¯åœ¨æœ€åçš„æƒ…å†µä¸‹ä»ç„¶æ¯æ¬¡éƒ½éœ€è¦ç§»åŠ¨ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ç›´æ¥æ’å…¥æ’åºåœ¨æœ€åæƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œä¹Ÿæ˜¯ `O(n^2)`ã€‚

Shell å¢é‡åºåˆ—æ„é€ ä»£ç å¦‚ä¸‹ï¼š

```java
int IncrementSequence_Shell[35];
void IncrementSequenceBuild_Shell()
{
    IncrementSequence_Shell[0]=1;
    IncrementSequence_Shell[1]=n;
    while(IncrementSequence_Shell[IncrementSequence_Shell[0]]>1)
        IncrementSequence_Shell[++IncrementSequence_Shell[0]]=IncrementSequence_Shell[IncrementSequence_Shell[0]-1]/2;
}
```

Shellå¢é‡åºåˆ—ä¸æ»¡è¶³äº’è´¨çš„è¦æ±‚ï¼Œå› æ­¤åœ¨ä¸Šæ–¹å›¾1æ‰€ç¤ºçš„ä¾‹å­é‡Œï¼Œå‰å‡ ä¸ªå¢é‡æ²¡æœ‰èµ·åˆ°ä»»ä½•ä½œç”¨ï¼ˆåªèµ·åˆ°äº†æ‹–å»¶æ—¶é—´çš„ä½œç”¨å“ˆå“ˆï¼‰ã€‚

äºæ˜¯æœ‰äº›å¤§ä½¬ä»¬å°±æ•´å‡ºäº†ä¸‹é¢è¿™äº›å¢é‡åºåˆ—ï¼š**Hibbardå¢é‡åºåˆ—**ã€**Knuthå¢é‡åºåˆ—**ã€**Sedgewickå¢é‡åºåˆ—**ç­‰ç­‰ã€‚

### Hibbardå¢é‡åºåˆ—

Hibbardå¢é‡åºåˆ—çš„é€šé¡¹å…¬å¼ä¸ºï¼š
$$
h_i=2^iâˆ’1
$$
Hibbardå¢é‡åºåˆ—çš„é€’æ¨å…¬å¼ä¸ºï¼š
$$
h_1=1,h_i=2âˆ—h_{i-1}+1
$$
å³ï¼š
$$
{1, 3, 7, 15, 31, 63, 127, 255, 511, 1023, 2047, 4095, 8191...}
$$


æœ€åæ—¶é—´å¤æ‚åº¦ä¸ºğ‘‚(ğ‘^3/2)ï¼›å¹³å‡æ—¶é—´å¤æ‚åº¦çº¦ä¸ºğ‘‚(ğ‘^5/4)ã€‚

å…ˆæ¥ä¸ªHibbardå¢é‡åºåˆ—çš„è·å–ä»£ç ï¼š

```python
# Hibbardå¢é‡åºåˆ—
# D(i)=2^iâˆ’1,i>0
def getHibbardStepArr(n):
    i = 1
    arr = []
    while True:
        tmp = (1 << i) - 1
        if tmp <= n:
            arr.append(tmp)
        else:
            break
        i += 1
    return arr
```

æ’åºä»£ç ç¨å¾®ä¿®æ”¹ä¸€ä¸‹å°±è¡Œï¼š

```python
# å¸Œå°”æ’åºï¼ˆHibbardå¢é‡åºåˆ—ï¼‰
def shellSort(arr):
    size = len(arr)
    # è·å–Hibbardå¢é‡åºåˆ—
    stepArr = getHibbardStepArr(size)
    # å› ä¸ºè¦å€’ç€ä½¿ç”¨åºåˆ—é‡Œçš„å¢é‡ï¼Œæ‰€ä»¥è¿™é‡Œç”¨äº†reversed
    for step in reversed(stepArr):
        for i in range(step, size):
            j = i
            tmp = arr[j]
            while j >= step:
                if tmp < arr[j - step]:
                    arr[j] = arr[j - step]
                    j -= step
                else:
                    break
            arr[j] = tmp
```

è‡³äºä¸ºä»€ä¹ˆè¦ç”¨pythonå†…ç½®å‡½æ•°`reversed()`ï¼Œè€Œä¸ç”¨å…¶å®ƒæ–¹æ³•ï¼Œæ˜¯å› ä¸º`reversed()`è¿”å›çš„æ˜¯è¿­ä»£å™¨ï¼Œå ç”¨å†…å­˜å°‘ï¼Œæ•ˆç‡æ¯”è¾ƒé«˜ã€‚
å¦‚æœå…ˆä½¿ç”¨`stepArr.reverse()`ï¼Œå†ç”¨`range(len(arr))`çš„è¯ï¼Œæ•ˆç‡ä¼šæ¯”è¾ƒä½ï¼›
è€Œä¸”å®æµ‹`reversed`ä¹Ÿæ¯”`range(len(arr) - 1, -1, -1)`æ•ˆç‡é«˜ï¼Œæ•…ä½¿ç”¨`reversed()`;
è¿˜æœ‰å°±æ˜¯å…ˆ`stepArr.sort(reverse=True)`ï¼Œå†ç”¨`range(len(arr))`ï¼ŒåŒæ ·æ•ˆç‡ä½ã€‚
è¿™å‡ ç§æ–¹æ³•æ¯”è¾ƒçš„æµ‹è¯•ä»£ç åœ¨è¿™é‡Œï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥çœ‹çœ‹ï¼š[Pythonåˆ—è¡¨å€’åºè¾“å‡ºåŠå…¶æ•ˆç‡](https://www.cnblogs.com/minxiang-luo/p/12405115.html)ã€‚

### Sedgewickå¢é‡åºåˆ—

Sedgewickå¢é‡åºåˆ—çš„å–æ³•ä¸ºï¼š
$$
h_i=max(9âˆ—4^iâˆ’9âˆ—2^i+1, 4^iâˆ’3âˆ—2^i+1)
$$
å³ï¼š
$$
{1, 5, 19, 41, 109, 209, 505, 929, 2161...}
$$
æœ€åæ—¶é—´å¤æ‚åº¦ä¸º ğ‘‚(ğ‘^4/3) ï¼›å¹³å‡æ—¶é—´å¤æ‚åº¦çº¦ä¸ºğ‘‚(ğ‘^7/6)ã€‚

Sedgewickå¢é‡åºåˆ—çš„è·å–ä»£ç ï¼š

```python
# Sedgewickå¢é‡åºåˆ—
# D=9*4^i-9*2^i+1 æˆ– 4^(i+2)-3*2^(i+2)+1 , i>=0
# ç¨å¾®å˜ä¸€ä¸‹å½¢ï¼šD=9*(2^(2i)-2^i)+1 æˆ– 2^(2i+4)-3*2^(i+2)+1 , i>=0
def getSedgewickStepArr(n):
    i = 0
    arr = []
    while True:
        tmp = 9 * ((1 << 2 * i) - (1 << i)) + 1
        if tmp <= n:
            arr.append(tmp)
        tmp = (1 << 2 * i + 4) - 3 * (1 << i + 2) + 1
        if tmp <= n:
            arr.append(tmp)
        else:
            break
        i += 1
    return arr
```

æ’åºä»£ç ç¨å¾®ä¿®æ”¹ä¸€ä¸‹å°±è¡Œï¼š

```python
# å¸Œå°”æ’åºï¼ˆSedgewickå¢é‡åºåˆ—ï¼‰
def shellSort(arr):
    size = len(arr)
    # è·å–Sedgewickå¢é‡åºåˆ—
    stepArr = getSedgewickStepArr(size)
    for step in reversed(stepArr):
        for i in range(step, size):
            j = i
            tmp = arr[j]
            while j >= step:
                if tmp < arr[j - step]:
                    arr[j] = arr[j - step]
                    j -= step
                else:
                    break
            arr[j] = tmp
```

### Knuthå¢é‡åºåˆ—

Knuth å¢é‡åºåˆ—çš„é€šé¡¹å…¬å¼ä¸ºï¼š
$$
h_i=(3^iâˆ’1)/2
$$
Knuth å¢é‡åºåˆ—çš„é€’æ¨å…¬å¼ä¸ºï¼š
$$
h_1=1,h_i=3âˆ—h_{iâˆ’1}+1
$$
å³ï¼š
$$
{1,4,13,40,121,364,1093,3280...}
$$
æ—¶é—´å¤æ‚åº¦æ˜¯ğ‘‚(ğ‘^3/2)ã€‚

Knuth å¢é‡åºåˆ—æ„é€ ä»£ç å¦‚ä¸‹ï¼š

```java
int IncrementSequence_Knuth[25];
void IncrementSequenceBuild_Knuth()
{
    IncrementSequence_Knuth[0]=20;
    IncrementSequence_Knuth[1]=1;
    for(int i=2;i<=20;i++)
        IncrementSequence_Knuth[i]=IncrementSequence_Knuth[i-1]*3+1;
}
```

## ç©ºé—´å¤æ‚åº¦

åœ¨å¸Œå°”æ’åºçš„å®ç°ä¸­ä»ç„¶ä½¿ç”¨äº†æ’å…¥æ’åºï¼Œåªæ˜¯è¿›è¡Œäº†åˆ†ç»„ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨å…¶ä»–ç©ºé—´ï¼Œæ‰€ä»¥å¸Œå°”æ’åºçš„[ç©ºé—´å¤æ‚åº¦](http://data.biancheng.net/view/2.html)åŒæ ·æ˜¯ `O(1)`ï¼Œæ˜¯å¸¸é‡çº§çš„ã€‚